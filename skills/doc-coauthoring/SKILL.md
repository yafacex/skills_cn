---
name: doc-coauthoring
description: 用结构化工作流带用户共创文档。用户要写文档、提案、技术规格、决策文档或类似结构化内容时使用。该工作流帮助用户高效转移上下文、通过迭代打磨内容，并验证文档对读者是否可用。当用户提到写 doc、做 proposal、起草 spec 等文档任务时触发。
---

# 文档共创工作流

此技能提供一套结构化流程，用于引导用户协作撰写文档。你要作为主动的引导者，带用户依次完成三个阶段：上下文收集（Context Gathering）、结构与打磨（Refinement & Structure）、读者测试（Reader Testing）。

## 何时提供该工作流

**触发条件：**
- 用户提到要写文档："write a doc"、"draft a proposal"、"create a spec"、"write up"
- 用户提到具体文档类型："PRD"、"design doc"、"decision doc"、"RFC"
- 用户看起来要开始一项较大的写作任务

**初次推荐：**
向用户提供一个结构化的共创工作流，并说明三个阶段：

1. **上下文收集（Context Gathering）**：用户提供相关背景，Claude 提出澄清问题
2. **结构与打磨（Refinement & Structure）**：通过头脑风暴与编辑，逐段迭代构建
3. **读者测试（Reader Testing）**：用一个“无上下文”的新 Claude 测试文档，提前发现盲点

解释这套流程能让文档在他人阅读时更好用（包括他人把文档粘贴进 Claude 的场景）。询问用户是想按该流程推进，还是自由写作（freeform）。

若用户拒绝，则按 freeform 工作；若用户接受，则进入阶段 1。

## 阶段 1：上下文收集（Context Gathering）

**目标：**缩小“用户已知”与“Claude 已知”的差距，为后续高质量引导打基础。

### 初始问题

先向用户询问文档的元信息：

1. 这是什么类型的文档？（如 technical spec、decision doc、proposal）
2. 主要读者是谁？
3. 读者看完后你希望产生什么影响？
4. 是否有模板或需要遵循的固定格式？
5. 还有哪些约束或背景需要提前知道？

告知用户可以用速记方式回答，或按自己最顺手的方式直接信息倾倒。

**如果用户提供模板或提到文档类型：**
- 询问是否有模板文档可分享
- 若提供共享文档链接，使用合适的集成去获取
- 若提供文件，则读取该文件

**如果用户提到要编辑一份已有的共享文档：**
- 使用合适的集成读取当前版本
- 检查是否存在缺少 alt-text 的图片
- 若存在缺少 alt-text 的图片，说明他人用 Claude 理解文档时 Claude 看不到图片内容。询问是否需要生成 alt-text；如需要，请求用户将每张图片粘贴到聊天中以生成描述性 alt-text。

### 信息倾倒（Info Dumping）

初始问题回答后，鼓励用户把已知背景一次性倾倒出来，可包括：
- 项目/问题背景
- 相关团队讨论或共享文档
- 为何不采用替代方案
- 组织背景（团队协作方式、过往事件、内部博弈等）
- 时间压力或限制
- 技术架构或依赖
- 相关方顾虑

提醒用户不要纠结组织结构，先把信息都倒出来。提供多种提供上下文的方式：
- 直接随想式信息倾倒
- 指向需要阅读的团队频道/讨论串
- 给出共享文档链接

**若可用集成存在**（如 Slack、Teams、Google Drive、SharePoint 或其他 MCP server），说明可以用它们直接拉取上下文。

**若未检测到集成且在 Claude.ai / Claude App：**建议用户在 Claude 设置中启用连接器（connectors），以便从消息工具与文档存储中直接拉取上下文。

告知用户在完成第一轮倾倒后，你会提出澄清问题。

**在上下文收集过程中：**

- 若用户提到团队频道或共享文档：
  - 若集成可用：告知将立即读取相关内容，然后使用合适的集成
  - 若集成不可用：说明无法访问，并建议启用连接器或直接粘贴相关内容

- 若用户提到未知实体/项目：
  - 询问是否需要在已连接工具中搜索以了解更多
  - 搜索前等待用户确认

- 用户提供信息时，持续追踪“已理解”与“仍不清楚”的点

**提出澄清问题：**

当用户表示已完成第一轮倾倒（或已提供足够多上下文）时，提出澄清问题以确保理解：

基于上下文缺口生成 5–10 个编号问题。

告知用户可以用速记回答（如 “1: yes, 2: see #channel, 3: no because backwards compat”），也可以继续贴更多文档、指向更多频道，或继续倾倒信息——以对方最高效的方式为准。

**退出条件：**
当你提出的问题已经能体现你理解了整体脉络，并且能直接讨论边界条件与权衡，而无需对方再补基础知识时，说明上下文已足够。

**过渡：**
询问用户此阶段是否还想补充更多背景，或是否可以进入撰写阶段。

若用户想补充则继续；准备好后进入阶段 2。

## 阶段 2：结构与打磨（Refinement & Structure）

**目标：**通过头脑风暴、筛选与迭代精修，按章节逐步构建文档。

**对用户的说明：**
解释文档会按章节逐步构建。每个章节都按以下步骤进行：
1. 先问澄清问题，确定应包含哪些内容
2. 头脑风暴 5–20 个可能点
3. 用户指定保留/删除/合并哪些点
4. 起草该章节正文
5. 通过外科手术式小改动迭代精修

从未知最多的章节开始（通常是核心决策/提案），然后推进其余章节。

**章节顺序：**

如果文档结构明确：
询问用户想从哪个章节开始。

建议优先从未知最多的章节开始。决策文档通常是核心提案；规格说明通常是技术方案。总结类章节一般放最后写最好。

如果用户不确定需要哪些章节：
根据文档类型与模板，给出 3–5 个适合该类型的章节建议。

询问该结构是否可用，或是否需要调整。

**当结构达成一致后：**

为所有章节创建初始骨架，并用占位文本填充。

**如果可以使用 artifacts：**
使用 `create_file` 创建 artifact，让 Claude 与用户都能在同一骨架上协作。

告知用户将创建带占位符的初始结构。

创建 artifact，包含所有章节标题，并配上简短占位符（如 “[To be written]” 或 “[Content here]”）。

提供骨架链接，并说明接下来要逐章填充内容。

**如果无法使用 artifacts：**
在工作目录创建一个 markdown 文件，文件名要贴合用途（如 `decision-doc.md`、`technical-spec.md`）。

告知用户将创建带占位符的初始结构。

创建文件，写入所有章节标题与占位符文本。

确认文件名已创建，并说明接下来要逐章填充内容。

**对每个章节：**

### 步骤 1：澄清问题

宣布开始处理 [SECTION NAME] 章节，并提出 5–10 个澄清问题，确定应包含哪些内容：

基于上下文与章节目的生成 5–10 个具体问题。

告知用户可以速记回答，或只指出最重要要覆盖的点即可。

### 步骤 2：头脑风暴

针对 [SECTION NAME] 章节，根据复杂度头脑风暴 [5–20] 个可能包含的点，重点寻找：
- 用户提过但可能被遗漏的背景
- 尚未提及的角度或考虑事项

按章节复杂度生成 5–20 个编号选项。最后询问是否还需要更多备选点。

### 步骤 3：筛选（Curation）

询问哪些点要保留/删除/合并，并请求简短理由，以便在后续章节把握优先级。

给出示例：
- “Keep 1,4,7,9”
- “Remove 3 (duplicates 1)”
- “Remove 6 (audience already knows this)”
- “Combine 11 and 12”

**如果用户用 freeform 方式反馈**（如 “looks good” 或 “I like most of it but...”），而不是按编号选择，则提取其偏好并继续推进：解析其想保留/删除/修改的内容并应用。

### 步骤 4：缺口检查（Gap Check）

基于用户选择，询问 [SECTION NAME] 章节是否还缺少任何重要内容。

### 步骤 5：起草（Drafting）

使用 `str_replace` 将该章节的占位文本替换为实际起草内容。

宣布将基于用户选择开始起草 [SECTION NAME] 章节。

**如果使用 artifacts：**
起草完成后提供 artifact 链接。

请用户通读并指出需要修改之处，并提醒越具体越有助于后续章节学习其偏好。

**如果使用本地文件（无 artifacts）：**
起草后确认完成。

告知 [SECTION NAME] 章节已写入 [filename]。请用户通读并指出需要修改之处，并提醒越具体越有助于后续章节学习其偏好。

**对用户的关键说明（在起草第一个章节时给出）：**
提示用户不要直接改文档，而是用文字指出需要改哪里，这样更利于学习其风格偏好。例如：“Remove the X bullet - already covered by Y” 或 “Make the third paragraph more concise”。

### 步骤 6：迭代精修（Iterative Refinement）

用户给出反馈后：
- 使用 `str_replace` 进行修改（绝不整篇重印）
- **如果使用 artifacts：**每次修改后提供 artifact 链接
- **如果使用文件：**仅确认修改已完成
- 若用户直接编辑文档并让你阅读：记住其改动方式并用于后续章节（这体现了偏好）

**持续迭代**，直到用户对该章节满意为止。

### 质量检查（Quality Checking）

若连续 3 次迭代都没有实质变化，询问是否能在不损失重要信息的前提下删掉一些内容。

章节完成后，确认 [SECTION NAME] 已完成，并询问是否进入下一章节。

**对所有章节重复上述流程。**

### 临近完成（Near Completion）

当接近完成（80%+ 章节已完成）时，宣布将重新通读全文并检查：
- 各章节的流畅性与一致性
- 冗余或矛盾
- 是否存在“slop”或泛化填充
- 是否每句话都有分量

通读全文并给出反馈。

**当所有章节都已起草并精修：**
宣布所有章节已完成，并说明将再完整复核一次。

检查整体一致性、行文流畅与完整性。

给出最终建议。

询问是否进入读者测试，或还想继续精修某些内容。

## 阶段 3：读者测试（Reader Testing）

**目标：**用一个“无上下文污染”的新 Claude 测试文档，验证其对读者是否可用。

**对用户的说明：**
解释接下来会测试文档是否真的对读者有效，以捕捉盲点——作者觉得理所当然但他人可能困惑的地方。

### 测试方式

**如果可用 sub-agents（如 Claude Code）：**

直接完成测试，无需用户参与。

### 步骤 1：预测读者问题

宣布将预测读者在尝试理解该文档时可能会问的问题。

生成 5–10 个读者真实可能会问的问题。

### 步骤 2：用 Sub-Agent 测试

宣布将用一个全新的 Claude 实例（不带本对话上下文）来测试这些问题。

对每个问题，仅向 sub-agent 提供文档内容与问题本身并调用。

总结“读者 Claude”每个问题答对/答错了什么。

### 步骤 3：额外检查

宣布将进行额外检查。

调用 sub-agent 检查歧义、错误前提与自相矛盾点。

总结发现的问题。

### 步骤 4：汇报并修复

如发现问题：
汇报读者 Claude 在哪些点上出现困难。

列出具体问题清单。

说明将修复这些缺口。

回到结构与打磨阶段，针对有问题的章节继续精修。

---

**如果无法使用 sub-agents（如 claude.ai 网页端）：**

需要用户手动完成测试。

### 步骤 1：预测读者问题

询问读者在试图理解该文档时会问什么问题？他们会在 Claude.ai 里输入什么？

生成 5–10 个读者真实可能会问的问题。

### 步骤 2：设置测试流程

提供测试说明：
1. 打开一个新的 Claude 对话：https://claude.ai
2. 粘贴或分享文档内容（若使用已启用 connectors 的共享文档平台，则提供链接）
3. 将上面生成的问题逐个问“读者 Claude”

对每个问题，要求读者 Claude 输出：
- 答案
- 是否存在歧义或不清晰处
- 文档默认读者已经知道的知识/上下文是什么

检查读者 Claude 是否给出正确答案，或是否误解了内容。

### 步骤 3：额外检查

另外让读者 Claude 回答：
- “What in this doc might be ambiguous or unclear to readers?”
- “What knowledge or context does this doc assume readers already have?”
- “Are there any internal contradictions or inconsistencies?”

### 步骤 4：基于结果迭代

询问读者 Claude 在哪些点上答错或卡住，并说明将修复这些缺口。

回到结构与打磨阶段，针对有问题的章节继续精修。

---

### 退出条件（两种方式通用）

当读者 Claude 持续能正确回答问题，且不再暴露新的缺口或歧义时，文档可视为可用。

## 最终复核

读者测试通过后：
宣布文档已通过读者 Claude 测试。在结束前：

1. 建议用户自己再通读一遍——文档归属用户，质量责任也在用户
2. 建议复核所有事实、链接与技术细节
3. 请用户确认文档达成了预期影响

询问是否还需要再做一次复核，还是可以收尾。

**若用户需要最终复核，则提供复核；否则：**
宣布文档完成，并给出几点收尾建议：
- 可在附录中链接本次对话，方便读者了解文档如何形成
- 用附录提供深度内容，避免主文档膨胀
- 收到真实读者反馈后持续更新文档

## 有效引导技巧

**语气：**
- 直接、流程化
- 只有在影响用户行为时才简要解释原因
- 不要“推销”方法论——直接执行即可

**处理偏离流程：**
- 若用户想跳过某阶段：询问是否改为 freeform 写作
- 若用户显得烦躁：承认耗时超预期，并给出更快推进的方法
- 始终给予用户调整流程的主动权

**上下文管理：**
- 全程若发现缺少关键上下文，要主动追问
- 不要让缺口累积——发现就及时补齐

**Artifact 管理：**
- 起草完整章节时使用 `create_file`
- 所有编辑都用 `str_replace`
- 每次修改后提供 artifact 链接
- 头脑风暴清单不要用 artifacts——直接对话即可

**质量优先于速度：**
- 不要仓促跳过阶段
- 每次迭代都要带来实质提升
- 目标是产出对读者真正有效的文档
